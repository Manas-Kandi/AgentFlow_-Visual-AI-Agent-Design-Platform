:root{
  --bg:#0b0c0f; --panel:#111317; --muted:#8a8f98; --text:#eef0f3;
  --border:rgba(255,255,255,.06); --accent:#4dd1a1; --danger:#ff6b6b;
  --radius:16px; --gap:8px; --shadow:0 6px 24px rgba(0,0,0,.3);
  --grid:rgba(255,255,255,.04);
  --fast:120ms; --med:160ms; --slow:220ms;
  --font: ui-sans-serif, Inter, system-ui, -apple-system, Roboto, "Segoe UI";
}

.af-header{
  position: sticky; top: 0; height:56px; display:flex; align-items:center; gap: var(--gap);
  padding: 0 16px; backdrop-filter:saturate(1.1) blur(8px); background: color-mix(in oklab, var(--bg), transparent 35%);
  border-bottom:1px solid var(--border); box-shadow: var(--shadow);
}
.af-title{ background:transparent; border:1px solid var(--border); border-radius:10px; padding:8px 12px; color:var(--text); font:600 14px var(--font); width: 320px; }
.af-header-actions{ margin-left:auto; display:flex; align-items:center; gap: var(--gap); }

.af-btn{ background:transparent; border:1px solid var(--border); color:var(--text); padding:6px 10px; border-radius:10px; transition:transform var(--fast), background var(--fast); }
.af-btn:hover{ transform: translateY(-1px); background: rgba(255,255,255,.03); }
.af-primary{ background: var(--accent); color:black; border-color: transparent; }

.af-model{ display:flex; align-items:center; gap:6px; }
.af-chip{ background: rgba(255,255,255,.06); border:1px solid var(--border); color:var(--text); border-radius:999px; padding:4px 10px; }
.af-select, .af-input, .af-code{ background:#0f1115; color:var(--text); border:1px solid var(--border); border-radius:10px; padding:8px 10px; font-family: var(--font); }

.af-stage{ position:relative; height: calc(100vh - 56px); overflow: hidden; background: var(--bg); }
.af-grid{ position:absolute; inset:0; background:
  radial-gradient(circle at 1px 1px, var(--grid) 1px, transparent 1px) 0 0/8px 8px,
  linear-gradient(var(--border), var(--border)) top/100% 1px no-repeat;
}

.af-node-wrapper{ position:absolute; will-change: transform; transition: transform var(--fast); }
.af-card{ width:260px; border:1px solid var(--border); border-radius: var(--radius); backdrop-filter: blur(6px); background: color-mix(in oklab, var(--panel), transparent 20%); box-shadow: var(--shadow); transition: transform 80ms; }
.af-card:hover{ transform: scale(1.02); }
.af-card-head{ display:flex; align-items:center; gap:8px; padding:10px; }
.af-card-emoji{ font-size:18px; }
.af-card-title{ color:var(--text); font:600 14px var(--font); }
.af-status{ width:8px; height:8px; border-radius:999px; margin-left:auto; }
.af-running{ background: #ffd166; }
.af-ok{ background: #4dd1a1; }
.af-error{ background: #ff6b6b; }

.af-ports{ display:flex; justify-content:space-between; padding:8px 10px 10px; }
.af-ports-col{ display:flex; flex-direction:column; gap:8px; }
.af-port{ width:10px; height:10px; border-radius:999px; border:2px solid var(--border); background: #16181d; box-shadow: 0 0 0 0 rgba(77, 209, 161, .0); transition: box-shadow var(--fast); }
.af-port:hover{ box-shadow: 0 0 0 6px rgba(77, 209, 161, .18); }

.af-edge{ position:absolute; inset:0; pointer-events:none; }
.af-edge-path{ stroke: rgba(255,255,255,.18); stroke-width:2; fill:none; }

.af-start-badge{ position:absolute; top:-10px; left:10px; background: rgba(77, 209, 161, .15); color: var(--text); border:1px solid var(--accent); border-radius:999px; font: 600 10px var(--font); padding: 2px 8px; }

.af-sidebar{ width:288px; border-right:1px solid var(--border); background: var(--panel); height: calc(100vh - 56px); display:flex; flex-direction:column; transition: width var(--med);
  overflow:hidden; }
.af-sidebar.is-collapsed{ width: 56px; }
.af-sidebar-header{ display:flex; gap:6px; padding:10px; }
.af-sidebar-content{ padding: 8px; display:flex; flex-wrap:wrap; gap:8px; }

.af-properties{ width:320px; border-left:1px solid var(--border); background: var(--panel); height: calc(100vh - 56px); padding: 10px; overflow:auto; }
.af-form{ display:flex; flex-direction:column; gap: 10px; }
.af-field{ display:flex; flex-direction:column; gap:6px; }
.af-label{ color:var(--muted); font: 500 12px var(--font); }

.af-dock{ position:fixed; left: 288px; right: 320px; bottom:0; height:320px; background: var(--panel); border-top:1px solid var(--border); transform: translateY(100%); transition: transform var(--med); }
.af-dock.is-open{ transform: translateY(0); }
.af-dock-header{ display:flex; align-items:center; justify-content:space-between; padding:8px 10px; border-bottom:1px solid var(--border); }
.af-tabs{ display:flex; gap:6px; }
.af-tab{ background:transparent; border:1px solid var(--border); color:var(--text); padding:6px 10px; border-radius:999px; }
.af-tab.is-active{ background: rgba(255,255,255,.08); }
.af-dock-body{ padding: 10px; height: calc(100% - 48px); overflow:auto; }

.af-menu{ position:absolute; background: var(--panel); border:1px solid var(--border); border-radius:10px; box-shadow: var(--shadow); padding:6px; }
.af-menu-item{ display:block; width:100%; text-align:left; background:transparent; border:none; color:var(--text); padding:8px 10px; border-radius:8px; }
.af-menu-item:hover{ background: rgba(255,255,255,.06); }
.af-menu-item.is-danger{ color: var(--danger); }

.af-palette{ position: fixed; inset: 0; display: grid; place-items: center; background: rgba(0,0,0,.5); }
.af-palette-inner{ width: 560px; background: var(--panel); border:1px solid var(--border); border-radius: 12px; padding: 10px; box-shadow: var(--shadow); }
.af-palette-list{ margin-top:10px; display:flex; flex-direction:column; gap:6px; max-height: 320px; overflow:auto; }

.af-empty{ display:grid; place-items:center; height: calc(100vh - 56px); color: var(--muted); }

/* Focus states */
.af-btn:focus, .af-input:focus, .af-select:focus, .af-menu-item:focus, .af-chip:focus{ outline: 2px solid var(--accent); outline-offset: 2px; }
